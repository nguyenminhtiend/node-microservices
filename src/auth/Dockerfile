FROM node:12.13-alpine

RUN mkdir -p /usr/app
RUN mkdir -p /usr/app/src

WORKDIR /usr/app

COPY package*.json ./

RUN npm install --only=production

COPY src/shared ./src/shared
COPY src/auth ./src/auth

ENV AUTH_PORT=3001
ENV NODE_ENV=production
ENV AUTH_DB_HOST=34.87.24.227
ENV AUTH_DB_PORT=3306
ENV AUTH_DB_USERNAME=root
ENV AUTH_DB_PASSWORD=Password.123
ENV AUTH_DB_DATABASE=microservices-auth
ENV PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\n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\n-----END RSA PRIVATE KEY-----\n"
ENV PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAwHQVOurswNS3QOXZYT6+\ntt0vpgBFWA6YNi0dfKAoMwwt9vC+JL7O9/mglCa9ESqtL5SNHABP2u0UYymxMWum\nREiQE9Pz2fAvBxo5tDpA47q2+/UNVYfe4OT0oD/I2Ci/IB6+zrill1yHRBxU/O9X\nU22g3SNBnKNFMrQ3tJyPtdML9uiJpNCG5s2WwiFVsokdu7vPvKtH+Aatnen1Ymbh\nkMP8JuNCDOhN2nh8g0pP88a0KAzAHh1TURSONREXsKxHaJUnmU0QMsURFlHL6+L2\nJOh8qMmtDrW00y8iGUnRhTF51yYTPHIGTpgVQ3cgqPE1eyOypdUTW2jCD+CuQOOV\nIXPxgVIfW+i/v730F/66b1UfdSidsDndnPvvIjwLHT7VFZSiAInhN/il60KnYRAb\nuW979r3P/tab2LLGxOYPnw7JMyRdhvlKOn0Sdj+SJ2M1G/mp0J7mHyTf/sMowCpX\noDkkgFJjEIwIwAXx+gKx1QEKUwAu3qnCex5zp/C3GVCzeOOLv96xRxBl7Xyyb89Z\nNJ1+EpAUJtpjnCOpSXtY+VoKpHLoIUZiWpxEVpqlJC+JKpYbr64bD5m7PrThcgsj\n+t4wN3Jds0g1cF41YEOgi8z0eaDvwbq+zbM9QXzRj/vaemwxymxqAx+K7tW99gRp\nywl3XVIHzrvQ+6aXTDSFPdECAwEAAQ==\n-----END PUBLIC KEY-----\n"

EXPOSE 3001

CMD ["node", "src/shared/startService.js", "User"]